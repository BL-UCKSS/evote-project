<html lang="ko">

<head>
    <%- include('head.ejs'); %>
</head>

<body style="text-align: center;">
    <%- include('header.ejs'); %>
    <% if(session.userid) { %>
        <a href="/logout" class="">로그아웃</a>&nbsp;
    <% } else { %>
        <script>location.replace('/');</script>
    <% } %>
    <div class="posts">
            <h1>내 투표 확인</h1>
            <!--input type="text" id="key" placeholder="Enter Key to Query"><br-->
            <!--button onclick="querybykey()">Query</button><br-->
            <div id="querybykey"><b></b></div><br>
            <!---->
    </div>
    </div>

</body>

<script type="text/javascript">
    $(function(){
        querybykey();
    })
    var querybykey = function () {
        var key = '<%=session.userid%>';
        if (key != '' || key  != undefined ) {
            $.ajax({
                type: "POST",
                url: '/queryByKey',
                data: { 'key': key },
                success: function (data) {
                    // picked, voterId
                    var picked = data.picked;
                    if(picked == 'blank'){
                        picked = '기권';
                    }
                    if(picked == undefined){
                        picked = '투표안함';    
                    }
                    var str = '<h3>내 학번 : '+data.voterId+'</h3><h3>투표 : '+picked+'</h3>';
                    
                    $('#querybykey > b').html(str);
                }
            })
        }
    }
</script>

</html>