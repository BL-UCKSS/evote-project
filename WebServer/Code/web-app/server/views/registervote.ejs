<!doctype html>
<html lang="ko">
  <head>
	<%- include('head.ejs'); %>
	<link rel="stylesheet" href="/public/bootstrap-datepicker.min.css">
    <title>Register Vote Page</title>
  </head>
<% if(session.userid != 'admin' && session.g != 'Y') { %>
   <script>document.location.href="/login";</script>
<% } else { %>
  <body class="loginbody">
    <div class="text-center">
        <%- include('header2.ejs'); %>
		
		<form action="/process/registervote" method="post" name="register">
		<div id="page1">
			<div class="register-box">
				<div class="in-register-box"> 
					<p class="registertext">선거 이름</p>
					<div class="form-group">
						<input type="text" class="form-control" name="name" placeholder="선거명을 입력해 주세요."  >
					</div>
					<p class="registertext">시작 날짜 선택</p>
					<input type="text" id="startdate" class="form-control" name="startdate" value="2020-08-01">
					<br><p class="registertext">종료 날짜 선택</p>
					<input type="text" id="enddate" class="form-control" name="enddate" value="2020-08-02">
				</div>
				<div class="registervotebtns">
				<button data-toggle="modal" data-target="#cancelRegisterVoteModal" class="nregisterbtn btn" onclick="return false;">취소</button>
				<button class="registerbtn btn" onclick="goNextPage(1, 2);return false;">다음</button>
				</div>
			</div>
		</div>		

		<div id="page2">
    		<div class="register-box">
				<div class="candidate-img-box" style="border-radius: 0; width: 100%">
				<label for="himage_file">
					<input type="file" id="himage_file" name="himage" style="width:1px;height:1px;overflow:hidden;margin:-1px;position: absolute; border:0; padding:0;clip:rect(0,0,0,0);">
    				<div data-obj-id="oQMoJ" data-obj-type="element" data-text-editable="true" class="" style="position: absolute; top: 75px; left: 20px; width: 80px; height: 20px;"><div data-text-content="true" style="font-size: 12px; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.227) 3px 3px 8px 0px; background-color: rgba(250, 250, 250, 0.49);">선거운동본부</div></div>
    				<div data-obj-id="ftabY" data-obj-type="icon" class="himage_icon" style="position: absolute; top: 75px; left: 132.5px; width: 95px; height: 100px;cursor: pointer;" data-released-from-group="VdIJ0">
    					<svg xmlns="http://www.w3.org/2000/svg" width="100" height="120" viewBox="0 0 48 48" data-svg-content="true" fill="rgb(255, 255, 255)">
    						<path d="M24 24c4.42 0 8-3.59 8-8 0-4.42-3.58-8-8-8s-8 3.58-8 8c0 4.41 3.58 8 8 8zm0 4c-5.33 0-16 2.67-16 8v4h32v-4c0-5.33-10.67-8-16-8z"></path></svg></div>
							<br><br><br><p style="text-align: center; color: #ffffff; font-size: 11px;">여기를 클릭하여<br>선거운동본부 이미지를 등록해주세요.</p>
				</label>
				</div>
	    		<div class="in-candidate-box"> 
	    			<p class="registertext">선거운동본부 명칭</p>
	    			<div class="form-group">
					    <input type="text" class="form-control" style="height: 24px;" id="hname" name="hname" placeholder="선거운동본부 명칭을 입력해 주세요."  ></div>
	    			<p class="registertext">소견문</p>
	    			<div class="form-group">
					    <input type="text" class="form-control" style="height: 24px;" id="link" name="link" placeholder="소견문 링크를 입력해 주세요."  ></div>
				</div>
				<div class="registerbtns">
	    		<button class="nregisterbtn btn" onclick="goNextPage(2, 1);return false;">뒤로</button>
	    		<button class="registerbtn btn" onclick="goNextPage(2, 3);return false;">다음</button>
	    		</div>
    		</div>
		</div>
		
		<div id="page3">
    		<div class="register-box">
				<div data-toggle="modal" data-target="#addToImageModal" class="btn candidate-img-box" style="border-radius: 0; width: 100%">
					<label for="image3_file">
						<input type="file" id="image3_file" name="image" style="width:1px;height:1px;overflow:hidden;margin:-1px;position: absolute; border:0; padding:0;clip:rect(0,0,0,0);">
    				<div data-obj-id="oQMoJ" data-obj-type="element" data-text-editable="true" class="" style="position: absolute; top: 75px; left: 20px; width: 40px; height: 20px;"><div data-text-content="true" style="font-size: 12px; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.227) 3px 3px 8px 0px; background-color: rgba(250, 250, 250, 0.49);">정후보</div></div>
                    <div data-obj-id="ftabY" data-obj-type="icon" class="" style="position: absolute; top: 75px; left: 132.5px; width: 95px; height: 100px;" data-released-from-group="VdIJ0">
    					<svg xmlns="http://www.w3.org/2000/svg" width="100" height="120" viewBox="0 0 48 48" data-svg-content="true" fill="rgb(255, 255, 255)">
    						<path d="M24 24c4.42 0 8-3.59 8-8 0-4.42-3.58-8-8-8s-8 3.58-8 8c0 4.41 3.58 8 8 8zm0 4c-5.33 0-16 2.67-16 8v4h32v-4c0-5.33-10.67-8-16-8z"></path></svg></div>
				<br><br><br><p style="text-align: center; color: #ffffff; font-size: 11px;">여기를 클릭하여<br>정후보 이미지를 등록해주세요.</p>
				</label>
    			</div>
	    		<div class="in-candidate-box"> 
	    			<p class="candidatetext">학과</p>
	    			<div class="form-group">
					    <input type="text" class="form-control" style="height: 24px;" id="dept" name="dept" placeholder="학과를 입력해 주세요."  ></div>
	    			<p class="candidatetext">학번</p>
	    			<div class="form-group">
					    <input type="text" class="form-control" style="height: 24px;" id="no" name="no" placeholder="학번을 입력해 주세요."  ></div>
                        <p class="candidatetext">학년</p>
                    <div class="form-group">
                        <input type="text" class="form-control" style="height: 24px;" id="grade" name="grade" placeholder="학년을 입력해 주세요."  ></div>
                    <p class="candidatetext">이름</p>
                    <div class="form-group">
                        <input type="text" class="form-control" style="height: 24px;" id="name" name="sname" placeholder="이름을 입력해 주세요."  ></div>
				</div>
				<div class="registerbtns">
	    		<button class="nregisterbtn btn" onclick="goNextPage(3, 2);return false;">뒤로</button>
	    		<button class="registerbtn btn" onclick="goNextPage(3, 4);return false;">다음</button>
	    		</div>
    		</div>
		</div>
		
		<div id="page4">
    		<div class="register-box">
				<div data-toggle="modal" data-target="#addToImageModal" class="btn candidate-img-box" style="border-radius: 0; width: 100%">
					<label for="image4_file">
						<input type="file" id="image4_file" name="image" style="width:1px;height:1px;overflow:hidden;margin:-1px;position: absolute; border:0; padding:0;clip:rect(0,0,0,0);">
    				<div data-obj-id="oQMoJ" data-obj-type="element" data-text-editable="true" class="" style="position: absolute; top: 75px; left: 20px; width: 40px; height: 20px;">
                        <div data-text-content="true" style="font-size: 12px; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.227) 3px 3px 8px 0px; background-color: rgba(250, 250, 250, 0.49);">부후보</div>
                    </div>
                    <div data-obj-id="ftabY" data-obj-type="icon" class="" style="position: absolute; top: 75px; left: 132.5px; width: 95px; height: 100px;" data-released-from-group="VdIJ0">
    					<svg xmlns="http://www.w3.org/2000/svg" width="100" height="120" viewBox="0 0 48 48" data-svg-content="true" fill="rgb(255, 255, 255)">
    						<path d="M24 24c4.42 0 8-3.59 8-8 0-4.42-3.58-8-8-8s-8 3.58-8 8c0 4.41 3.58 8 8 8zm0 4c-5.33 0-16 2.67-16 8v4h32v-4c0-5.33-10.67-8-16-8z"></path>
                        </svg>
                    </div>
				<br><br><br><p style="text-align: center; color: #ffffff; font-size: 11px;">여기를 클릭하여<br>부후보 이미지를 등록해주세요.</p>
				</label>
    			</div>
	    		<div class="in-candidate-box"> 
	    			<p class="candidatetext">학과</p>
	    			<div class="form-group">
					    <input type="text" class="form-control" style="height: 24px;" id="dept" name="dept" placeholder="학과를 입력해 주세요."  ></div>
	    			<p class="candidatetext">학번</p>
	    			<div class="form-group">
					    <input type="text" class="form-control" style="height: 24px;" id="no" name="no" placeholder="학번을 입력해 주세요."  ></div>
                        <p class="candidatetext">학년</p>
                    <div class="form-group">
                        <input type="text" class="form-control" style="height: 24px;" id="grade" name="grade" placeholder="학년을 입력해 주세요."  ></div>
                    <p class="candidatetext">이름</p>
                    <div class="form-group">
                        <input type="text" class="form-control" style="height: 24px;" id="name" name="sname" placeholder="이름을 입력해 주세요."  ></div>
				</div>
				<div><button class="btn btn-outline-primary" onclick="addNewPage(4);return false;" style="width:100px;margin-bottom:0px;margin-top:-30px;">추가</button></div>
				<div class="registerbtns">
	    		<button class="nregisterbtn btn" onclick="goNextPage(4, 3);return false;">뒤로</button>
	    		<button class="registerbtn btn" onclick="goNextPage(4, 5);return false;">확인</button>
	    		</div>
    		</div>
    	</div>
		</form>
		</div>
		<!-- ------------------------------------------------------------------------------------------------------------------------------------------------ -->
    
        <!-- Modal -->
        <div class="modal fade" id="cancelRegisterVoteModal" tabindex="-1" role="dialog" aria-labelledby="cancelRegisterVoteModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content small-modal-content vote-modal">
              <div class="modal-body" style="text-align: center;">
                <p class="mb1">정말로 취소하시겠습니까?</p>
                <p class="mb2">(입력하신 정보는 저장되지 않습니다.)</p>
              </div>
              <div class="vote-modal-footer modal-footer">
                <button type="button" class="cancel-vote btn btn-primary" data-dismiss="modal">취소</button>
                <button type="button" class="confirm-vote btn btn-primary" onclick="document.location.href='/adminMain'">확인</button>
              </div>
            </div>
          </div>
		</div>

		<div class="modal fade" id="finalRegisterCandidateModal" tabindex="-1" role="dialog" aria-labelledby="finalRegisterCandidateModalLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-centered" role="document">
			  <div class="modal-content small-modal-content vote-modal">
				<div class="modal-body" style="text-align: center;">
				  <span>입력한 선거를 등록하시겠습니까?</span>
				</div>
				<div class="vote-modal-footer modal-footer">
				  <button type="button" class="cancel-vote btn btn-primary" data-dismiss="modal">취소</button>
				  <button type="button" class="confirm-vote btn btn-primary" onclick="document.register.submit();">확인</button>
				</div>
			  </div>
			</div>
		</div>

        <%- include('foot.ejs'); %>
		<script type="text/javascript" src="/public/script.js"></script>
		<script src="/public/bootstrap-datepicker.min.js"></script>
		<script src="/public/bootstrap-datepicker.ko.min.js"></script>
		<script>
			$(document).ready(function() {	
				$('#startdate').datepicker({
					format: "yyyy-mm-dd",	//데이터 포맷 형식(yyyy : 년 mm : 월 dd : 일 )
					autoclose : true,	//사용자가 날짜를 클릭하면 자동 캘린더가 닫히는 옵션
					calendarWeeks : false, //캘린더 옆에 몇 주차인지 보여주는 옵션 기본값 false 보여주려면 true
					clearBtn : false, //날짜 선택한 값 초기화 해주는 버튼 보여주는 옵션 기본값 false 보여주려면 true
					disableTouchKeyboard : false,	//모바일에서 플러그인 작동 여부 기본값 false 가 작동 true가 작동 안함.
					immediateUpdates: false,	//사용자가 보는 화면으로 바로바로 날짜를 변경할지 여부 기본값 :false 
					multidate : false, //여러 날짜 선택할 수 있게 하는 옵션 기본값 :false 
					multidateSeparator :",", //여러 날짜를 선택했을 때 사이에 나타나는 글짜 2019-05-01,2019-06-01
					templates : {
						leftArrow: '&laquo;',
						rightArrow: '&raquo;'
					}, //다음달 이전달로 넘어가는 화살표 모양 커스텀 마이징 
					showWeekDays : true ,// 위에 요일 보여주는 옵션 기본값 : true
					title: "투표날짜",	//캘린더 상단에 보여주는 타이틀
					todayHighlight : true ,	//오늘 날짜에 하이라이팅 기능 기본값 :false 
					toggleActive : true,	//이미 선택된 날짜 선택하면 기본값 : false인경우 그대로 유지 true인 경우 날짜 삭제
					weekStart : 0 ,//달력 시작 요일 선택하는 것 기본값은 0인 일요일 
					language : "ko"	//달력의 언어 선택, 그에 맞는 js로 교체해줘야한다.
					
				});//datepicker end
				$('#enddate').datepicker({
					format: "yyyy-mm-dd",	//데이터 포맷 형식(yyyy : 년 mm : 월 dd : 일 )
					autoclose : true,	//사용자가 날짜를 클릭하면 자동 캘린더가 닫히는 옵션
					calendarWeeks : false, //캘린더 옆에 몇 주차인지 보여주는 옵션 기본값 false 보여주려면 true
					clearBtn : false, //날짜 선택한 값 초기화 해주는 버튼 보여주는 옵션 기본값 false 보여주려면 true
					disableTouchKeyboard : false,	//모바일에서 플러그인 작동 여부 기본값 false 가 작동 true가 작동 안함.
					immediateUpdates: false,	//사용자가 보는 화면으로 바로바로 날짜를 변경할지 여부 기본값 :false 
					multidate : false, //여러 날짜 선택할 수 있게 하는 옵션 기본값 :false 
					multidateSeparator :",", //여러 날짜를 선택했을 때 사이에 나타나는 글짜 2019-05-01,2019-06-01
					templates : {
						leftArrow: '&laquo;',
						rightArrow: '&raquo;'
					}, //다음달 이전달로 넘어가는 화살표 모양 커스텀 마이징 
					showWeekDays : true ,// 위에 요일 보여주는 옵션 기본값 : true
					title: "투표날짜",	//캘린더 상단에 보여주는 타이틀
					todayHighlight : true ,	//오늘 날짜에 하이라이팅 기능 기본값 :false 
					toggleActive : true,	//이미 선택된 날짜 선택하면 기본값 : false인경우 그대로 유지 true인 경우 날짜 삭제
					weekStart : 0 ,//달력 시작 요일 선택하는 것 기본값은 0인 일요일 
					language : "ko"	//달력의 언어 선택, 그에 맞는 js로 교체해줘야한다.
					
				});//datepicker end
			});//ready end
		</script>
		<script>
			$(document).ready(function(){
				$('#page2').css('display', 'none');
				$('#page3').css('display', 'none');
				$('#page4').css('display', 'none');
				refresh_event();
			});
			var refresh_event = function(){
				$('input[type=file]').change(function(){
					var target = this.id;
					if($('#'+target).val().length != 0){
						var fileInput = document.getElementById(target);
						var reader = new FileReader();
						reader.readAsDataURL(fileInput.files[0]);

						reader.onload = function () {
							$('#'+target).next().next().replaceWith('<img style=\'width:95px;height:100px;margin-bottom:-40px;\' src=\''+reader.result+'\'>');
						};
						reader.onerror = function (error) {
							console.log('Error: ', error);
						};
					}
				});
			};
			var checkempty = function(hide){
				var test = $(hide+' :input[type=text],'+hide+' :input[type=file]');
				for(var i=0; i<test.length; i++){
					if(test[i].value == '' || test[i].value.length == 0){
						return false;
					}
				}
				return true;
			}
			var goNextPage = function(id, page){
				var hide = '#page' + id;
				var show = '#page' + page;
				var empty = checkempty(hide);
				var last_page = $('form > div').length;
				if(empty){
					$(hide).css('display', 'none');
					$(show).css('display', '');
					if(page == last_page + 1){
						$(hide).css('display', '');
						$('#finalRegisterCandidateModal').modal('toggle');
					}
				}else{
					alert("모든 값을 입력해야 다음 페이지로 넘어갈 수 있습니다.");
				}
				return false;
			}
			var addNewPage = function(page){
				var id = 'page'+page;
				var jung_page = page + 1;
				var bu_page = page + 2;
				$('#'+id+' .registerbtns > button:last').text('다음');
				$('#'+id+' .registerbtns > button:last').attr('onclick','goNextPage('+page+','+jung_page+');return false;');
				$('.btn-outline-primary').replaceWith('<p style="font-size:10px;margin-bottom:0px;">추가되었습니다.</p>');
				$('#'+id).after('<div id="page'+bu_page+'" style="display:none;"><div class="register-box"><div data-toggle="modal" data-target="#addToImageModal" class="btn candidate-img-box" style="border-radius: 0; width: 100%"><label for="image'+bu_page+'_file"><input type="file" id="image'+bu_page+'_file" name="image" style="width:1px;height:1px;overflow:hidden;margin:-1px;position: absolute; border:0; padding:0;clip:rect(0,0,0,0);"><div data-obj-id="oQMoJ" data-obj-type="element" data-text-editable="true" class="" style="position: absolute; top: 75px; left: 20px; width: 40px; height: 20px;"><div data-text-content="true" style="font-size: 12px; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.227) 3px 3px 8px 0px; background-color: rgba(250, 250, 250, 0.49);">부후보</div></div><div data-obj-id="ftabY" data-obj-type="icon" class="" style="position: absolute; top: 75px; left: 132.5px; width: 95px; height: 100px;" data-released-from-group="VdIJ0"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="120" viewBox="0 0 48 48" data-svg-content="true" fill="rgb(255, 255, 255)"><path d="M24 24c4.42 0 8-3.59 8-8 0-4.42-3.58-8-8-8s-8 3.58-8 8c0 4.41 3.58 8 8 8zm0 4c-5.33 0-16 2.67-16 8v4h32v-4c0-5.33-10.67-8-16-8z"></path></svg></div><br><br><br><p style="text-align: center; color: #ffffff; font-size: 11px;">여기를 클릭하여<br>부후보 이미지를 등록해주세요.</p></label></div><div class="in-candidate-box"> <p class="candidatetext">학과</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="dept" name="dept" placeholder="학과를 입력해 주세요."></div><p class="candidatetext">학번</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="no" name="no" placeholder="학번을 입력해 주세요."></div><p class="candidatetext">학년</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="grade" name="grade" placeholder="학년을 입력해 주세요."></div><p class="candidatetext">이름</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="name" name="sname" placeholder="이름을 입력해 주세요."></div></div><div><button class="btn btn-outline-primary" onclick="addNewPage('+(bu_page)+');return false;" style="width:100px;margin-bottom:0px;margin-top:-30px;">추가</button></div><div class="registerbtns"><button class="nregisterbtn btn" onclick="goNextPage('+bu_page+', '+jung_page+');return false;">뒤로</button><button class="registerbtn btn" onclick="goNextPage('+bu_page+', '+(bu_page+1)+');return false;">확인</button></div></div></div>');
				$('#'+id).after('<div id="page'+jung_page+'" style="display:none;"><div class="register-box"><div data-toggle="modal" data-target="#addToImageModal" class="btn candidate-img-box" style="border-radius: 0; width: 100%"><label for="image'+jung_page+'_file"><input type="file" id="image'+jung_page+'_file" name="image" style="width:1px;height:1px;overflow:hidden;margin:-1px;position: absolute; border:0; padding:0;clip:rect(0,0,0,0);"><div data-obj-id="oQMoJ" data-obj-type="element" data-text-editable="true" class="" style="position: absolute; top: 75px; left: 20px; width: 40px; height: 20px;"><div data-text-content="true" style="font-size: 12px; border-radius: 2px; box-shadow: rgba(0, 0, 0, 0.227) 3px 3px 8px 0px; background-color: rgba(250, 250, 250, 0.49);">정후보</div></div><div data-obj-id="ftabY" data-obj-type="icon" class="" style="position: absolute; top: 75px; left: 132.5px; width: 95px; height: 100px;" data-released-from-group="VdIJ0"><svg xmlns="http://www.w3.org/2000/svg" width="100" height="120" viewBox="0 0 48 48" data-svg-content="true" fill="rgb(255, 255, 255)"><path d="M24 24c4.42 0 8-3.59 8-8 0-4.42-3.58-8-8-8s-8 3.58-8 8c0 4.41 3.58 8 8 8zm0 4c-5.33 0-16 2.67-16 8v4h32v-4c0-5.33-10.67-8-16-8z"></path></svg></div><br><br><br><p style="text-align: center; color: #ffffff; font-size: 11px;">여기를 클릭하여<br>정후보 이미지를 등록해주세요.</p></label></div><div class="in-candidate-box"><p class="candidatetext">학과</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="dept" name="dept" placeholder="학과를 입력해 주세요."></div><p class="candidatetext">학번</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="no" name="no" placeholder="학번을 입력해 주세요."></div><p class="candidatetext">학년</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="grade" name="grade" placeholder="학년을 입력해 주세요."></div><p class="candidatetext">이름</p><div class="form-group"><input type="text" class="form-control" style="height: 24px;" id="name" name="sname" placeholder="이름을 입력해 주세요."></div></div><div class="registerbtns"><button class="nregisterbtn btn" onclick="goNextPage('+jung_page+', '+page+');return false;">뒤로</button><button class="registerbtn btn" onclick="goNextPage('+jung_page+', '+bu_page+');return false;">다음</button></div></div></div>');
				refresh_event();
			}
		</script>
      </body>
    <% } %>
    </html>   